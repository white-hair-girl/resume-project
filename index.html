<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>easy-go-resume</title>

  <!-- 引入 Quill 的样式和脚本 -->
  <link href="./scss/quill.snow.css" rel="stylesheet">
  <link rel="stylesheet" href="scss/quill-customize-lineheight.css">
  <link rel="stylesheet" href="scss/style.min.css">
</head>

<body>
  <!-- 操作面板 -->

  <div class="left-container">

    <div id="operation-panel">

      <div class="operation-item">
        <span data-i18n="operationOptionsTitle.title1"></span>

        <div class="example-language">
          <!-- 下拉单选框 -->
          <div class="dropdown roleDropdown">
            <div class="dropdown-button" id="roleDropdownButton" data-i18n="resumeExampleDropdown.title"></div>
            <div class="dropdown-options" id="roleDropdownOptions">
              <div class="roleDropdown-option" data-value="miku" data-i18n="resumeExampleDropdown.options.miku"></div>
              <div class="roleDropdown-option" data-value="momoka" data-i18n="resumeExampleDropdown.options.momoka">
              </div>
              <div class="roleDropdown-option" data-value="ShigureUi"
                data-i18n="resumeExampleDropdown.options.ShigureUi"></div>
              <div class="roleDropdown-option" data-value="GawrGura" data-i18n="resumeExampleDropdown.options.GawrGura">
              </div>
              <div class="roleDropdown-option" data-value="TadokoroKoji"
                data-i18n="resumeExampleDropdown.options.TadokoroKoji"></div>
              <div class="roleDropdown-option" data-value="griffith" data-i18n="resumeExampleDropdown.options.griffith">
              </div>
              <div class="roleDropdown-option" data-value="voldemort"
                data-i18n="resumeExampleDropdown.options.voldemort"></div>
              <!-- <div class="roleDropdown-option" data-value="style-5">样式 5</div> -->
            </div>
          </div>
          <!-- 下拉单选框 -->
          <div class="dropdown langDropdown">
            <div class="dropdown-button" id="langDropdownButton" data-i18n="langDropdown.title"></div>
            <div class="dropdown-options" id="langDropdownOptions">
              <div class="langDropdown-option" data-value="en" data-i18n="langDropdown.options.en"></div>
              <div class="langDropdown-option" data-value="ja" data-i18n="langDropdown.options.ja"></div>
              <div class="langDropdown-option" data-value="zh" data-i18n="langDropdown.options.zh"></div>
            </div>
          </div>
        </div>

      </div>

      <div class="operation-item">
        <span data-i18n="operationOptionsTitle.title4"></span>

        <div class="btn-box">
          <button id="upload-avatar" class="confirm" data-i18n="btns.uploadAvatar"></button>
          <button id="delete-avatar" class="cancel" data-i18n="btns.deleteAvatar"></button>
        </div>
      </div>

      <div class="operation-item">
        <span data-i18n="operationOptionsTitle.title2"></span>

        <div class="add-section-box">
          <input type="text" id="section-title" />
          <button id="add-section" class="confirm" data-i18n="btns.add"></button>
        </div>
      </div>

      <div class="operation-item">
        <span data-i18n="operationOptionsTitle.title3"></span>

        <div class="h2-style-box">
          <!-- 下拉单选框 -->
          <div class="dropdown">
            <div class="dropdown-button" id="dropdownButton" data-i18n="H2Dropdown.options.style"></div>
            <div class="dropdown-options" id="dropdownOptions">
              <div class="dropdown-option" data-value="" data-i18n="H2Dropdown.options.style"></div>
              <div class="dropdown-option" data-value="style-1" data-i18n="H2Dropdown.options.style1"></div>
              <div class="dropdown-option" data-value="style-2" data-i18n="H2Dropdown.options.style2"></div>
              <div class="dropdown-option" data-value="style-3" data-i18n="H2Dropdown.options.style3"></div>
              <div class="dropdown-option" data-value="style-4" data-i18n="H2Dropdown.options.style4"></div>
              <div class="dropdown-option" data-value="style-5" data-i18n="H2Dropdown.options.style5"></div>
            </div>
          </div>

          <!-- 颜色选择器 -->
          <div class="color-HEX-picker">
            <input type="text" id="colorHEXInput" value="#cccccc" placeholder="color">
          </div>
          <!-- 颜色选择器 -->
          <div class="color-picker">
            <input type="color" id="colorInput" value="#cccccc" placeholder="color">
          </div>
        </div>

      </div>

      <div class="operation-item">
        <span data-i18n="operationOptionsTitle.title5"></span>

        <div class="progress-container" id="progress2"></div>
      </div>

      <div class="operation-item">
        <span data-i18n="operationOptionsTitle.title6"></span>

        <div class="progress-container" id="progress1"></div>
      </div>

      <div class="operation-item">
        <span data-i18n="operationOptionsTitle.title7"></span>
        <div class="btn-box">
          <button id="locationStorage" class="confirm" data-i18n="btns.storage"></button>
          <button id="clearLocalStorage" class="cancel" data-i18n="btns.clear"></button>
        </div>
      </div>

      <div class="operation-item">
        <span data-i18n="operationOptionsTitle.title8"></span>
        <div class="btn-box">
          <button id="printPDF" class="confirm" data-i18n="btns.print"></button>
          <button id="exportImg" class="confirm" data-i18n="btns.exportImg"></button>
        </div>
      </div>

      <div class="operation-item">
        <span data-i18n="operationOptionsTitle.title9"></span>
        <div class="btn-box">
          <button id="exportText" class="confirm" data-i18n="btns.exportText"></button>
          <button id="importText" class="confirm" data-i18n="btns.importText"></button>
        </div>
      </div>

    </div>

    <div class="collapse-panel">
      <span>👈&nbsp;&nbsp;</span>
      <span data-i18n="btns.collapsePanel"></span>
      <span>👈</span>
    </div>

    <div class="ReimuHakurei">
      <img src="./img/aside.png" alt="">
    </div>
  </div>

  <div class="right-container">
    <!-- 简历盒子 -->
    <div id="resumeBox"></div>
  </div>

  <!-- 二次确认弹窗 -->
  <div class="overlay" id="confirmationOverlay">
    <div class="confirm-dialog">
      <p data-i18n="clearDialog.description"></p>
      <div class="btn-box">
        <button class="cancel" id="cancelClear" data-i18n="clearDialog.cancel"></button>
        <button id="confirmClear" data-i18n="clearDialog.confirm"></button>
      </div>
    </div>
  </div>

</body>

</html>

<!-- 引入 html2canvas 库 -->
<script src="./js/quill.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
<script type="module" src="./js/i18n.js"></script>
<script type="module" src="./js/index.js"></script>
<script>
  // 移动 section 模板
  function moveSection(button, direction) {
    // 获取当前按钮的父元素（即section）
    const currentSection = button.closest('.section');

    // 获取所有的section元素
    const allSections = Array.from(document.querySelectorAll('.section'));

    // 获取当前section的位置
    const currentIndex = allSections.indexOf(currentSection);

    // 如果方向是向上
    if (direction === 'up' && currentIndex > 0) {
      // 获取上一个section
      const prevSection = allSections[currentIndex - 1];

      // 添加移动动画
      currentSection.style.transition = 'transform 0.3s ease';
      prevSection.style.transition = 'transform 0.3s ease';

      let currentSectionHeight = currentSection.clientHeight;
      let prevSectionHeight = prevSection.clientHeight;

      // 让当前section和上一个section移动
      currentSection.style.transform = `translateY(-${prevSectionHeight}px)`;
      prevSection.style.transform = `translateY(${currentSectionHeight}px)`;

      // 使用setTimeout确保动画完成后交换位置
      setTimeout(() => {
        currentSection.style.transition = '';
        prevSection.style.transition = '';
        currentSection.style.transform = '';
        prevSection.style.transform = '';

        // 交换位置
        currentSection.parentNode.insertBefore(currentSection, prevSection);
      }, 300); // 等待300ms，确保动画完成
    }

    // 如果方向是向下
    if (direction === 'down' && currentIndex < allSections.length - 1) {
      // 获取下一个section
      const nextSection = allSections[currentIndex + 1];

      // 添加移动动画
      currentSection.style.transition = 'transform 0.3s ease';
      nextSection.style.transition = 'transform 0.3s ease';

      let currentSectionHeight = currentSection.clientHeight;
      let nextSectionHeight = nextSection.clientHeight;

      // 让当前section和下一个section移动
      currentSection.style.transform = `translateY(${nextSectionHeight}px)`;
      nextSection.style.transform = `translateY(-${currentSectionHeight}px)`;

      // 使用setTimeout确保动画完成后交换位置
      setTimeout(() => {
        currentSection.style.transition = '';
        nextSection.style.transition = '';
        currentSection.style.transform = '';
        nextSection.style.transform = '';

        // 交换位置
        currentSection.parentNode.insertBefore(nextSection, currentSection);
      }, 300); // 等待300ms，确保动画完成
    }
  }


  document.getElementById('exportImg').addEventListener('click', function () {
    // 获取要导出的元素
    const element = document.getElementById('resumeBox');

    // 使用 html2canvas 渲染为图片（使用回调方式）
    html2canvas(element, {
      onrendered: function (canvas) {
        // 创建一个图片链接
        const imgData = canvas.toDataURL('image/png');

        // 创建一个下载链接
        const link = document.createElement('a');
        link.href = imgData;
        link.download = 'resume.png';  // 设置文件名
        link.click();  // 模拟点击下载
      }
    });
  });

  // 删除 section 模板
  function removeSection(deleteBtn) {
    const section = deleteBtn.closest(".section");
    section.remove();
  }
</script>